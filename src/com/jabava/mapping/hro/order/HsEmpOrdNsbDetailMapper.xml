<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jabava.dao.hro.order.HsEmpOrdNsbDetailMapper" >
  <resultMap id="BaseResultMap" type="com.jabava.pojo.hro.order.HsEmpOrdNsbDetail" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="ord_nsb_detail_id" property="ordNsbDetailId" jdbcType="BIGINT" />
     <result column="company_id" property="companyId" jdbcType="BIGINT" />
    <result column="order_id" property="orderId" jdbcType="BIGINT" />
    <result column="quotation_name" property="quotationName" jdbcType="VARCHAR" />
    <result column="offer_id" property="offerId" jdbcType="BIGINT" />
    <result column="prod_name" property="prodName" jdbcType="VARCHAR" />
    <result column="item_id" property="itemId" jdbcType="BIGINT" />
    <result column="item_type" property="itemType" jdbcType="VARCHAR" />
    <result column="payment_month" property="paymentMonth" jdbcType="CHAR" />
    <result column="bill_month" property="billMonth" jdbcType="CHAR" />
    <result column="sum" property="sum" jdbcType="DECIMAL" />
    <result column="frequency" property="frequency" jdbcType="VARCHAR" />
    <result column="if_prepay" property="ifPrepay" jdbcType="INTEGER" />
    <result column="bill_template_id" property="billTemplateId" jdbcType="BIGINT" />
    <result column="create_user_id" property="createUserId" jdbcType="BIGINT" />
    <result column="create_date" property="createDate" jdbcType="TIMESTAMP" />
    <result column="update_user_id" property="updateUserId" jdbcType="BIGINT" />
    <result column="update_date" property="updateDate" jdbcType="TIMESTAMP" />
    <result column="is_deleted" property="isDeleted" jdbcType="INTEGER" />
    <result column="has_changed" property="hasChanged" jdbcType="INTEGER" />
    <result column="auto_add" property="autoAdd" jdbcType="INTEGER" />
    <result column="emp_relative_id" property="empRelativeId" jdbcType="BIGINT" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!-- 
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
     ord_nsb_detail_id,company_id, payment_month, order_id, quotation_name, offer_id, prod_name, 
    item_id, item_type, bill_month, sum, frequency, if_prepay, bill_template_id, create_user_id, 
    create_date, update_user_id, update_date, is_deleted, has_changed, auto_add, emp_relative_id
  </sql>
  <sql id="queryParams">
  	<where>
      	is_deleted = 0
      	<if test="companyId != null and companyId!=''">
		   AND company_id =#{companyId,jdbcType=BIGINT}
		</if>
  	   <if test="orderId != null" >
        AND  order_id = #{orderId,jdbcType=BIGINT}
      </if>
       <if test="paymentMonth != null and paymentMonth !=''" >
       AND  payment_month  = #{paymentMonth,jdbcType=CHAR}
      </if>
     <if test="paymentMonthStart != null and paymentMonthStart!=''" >
       AND  payment_month  <![CDATA[>=]]> #{paymentMonthStart,jdbcType=CHAR}
      </if>
      <if test="paymentMonthEnd != null and paymentMonthEnd!=''" >
       AND  payment_month  <![CDATA[<=]]> #{paymentMonthEnd,jdbcType=CHAR}
      </if>
      <if test="billMonthStart != null and billMonthStart!=''" >
        AND bill_month <![CDATA[>=]]> #{billMonthStart,jdbcType=CHAR}
      </if> 
       <if test="billMonthEnd != null and billMonthEnd!=''" >
        AND bill_month <![CDATA[<=]]> #{billMonthEnd,jdbcType=CHAR}
      </if>  	
  	</where>
  </sql>
  <!-- 根据账单月或者服务月查询 订单费用信息 -->
  <select id="findOrderCostPage" resultMap="BaseResultMap"  parameterType="java.util.HashMap"   >
 
    select 
    <include refid="Base_Column_List" />
    from hs_emp_ord_nsb_detail
    <include refid="queryParams" />  
 	 ORDER BY  payment_month ASC 
  </select>
  
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
 
    select 
    <include refid="Base_Column_List" />
    from hs_emp_ord_nsb_detail
    where ord_nsb_detail_id = #{ordNsbDetailId,jdbcType=BIGINT}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from hs_emp_ord_nsb_detail
    where ord_nsb_detail_id = #{ordNsbDetailId,jdbcType=BIGINT}
  </delete>
  
  <insert id="insert" parameterType="com.jabava.pojo.hro.order.HsEmpOrdNsbDetail" >
   
    insert into hs_emp_ord_nsb_detail (ord_nsb_detail_id,company_id, payment_month, order_id, 
      quotation_name, offer_id, prod_name, 
      item_id, item_type, bill_month, 
      sum, frequency, if_prepay, 
      bill_template_id, create_user_id, create_date, 
      update_user_id, update_date, is_deleted, 
      has_changed, auto_add, emp_relative_id)
    values (#{ordNsbDetailId,jdbcType=BIGINT}, =#{companyId,jdbcType=BIGINT},#{paymentMonth,jdbcType=CHAR}, #{orderId,jdbcType=BIGINT}, 
      #{quotationName,jdbcType=VARCHAR}, #{offerId,jdbcType=BIGINT}, #{prodName,jdbcType=VARCHAR}, 
      #{itemId,jdbcType=BIGINT}, #{itemType,jdbcType=VARCHAR}, #{billMonth,jdbcType=CHAR}, 
      #{sum,jdbcType=DECIMAL}, #{frequency,jdbcType=VARCHAR}, #{ifPrepay,jdbcType=INTEGER}, 
      #{billTemplateId,jdbcType=BIGINT}, #{createUserId,jdbcType=BIGINT}, #{createDate,jdbcType=TIMESTAMP}, 
      #{updateUserId,jdbcType=BIGINT}, #{updateDate,jdbcType=TIMESTAMP}, #{isDeleted,jdbcType=INTEGER}, 
      #{hasChanged,jdbcType=INTEGER}, #{autoAdd,jdbcType=INTEGER}, #{empRelativeId,jdbcType=BIGINT})
  </insert>
  <!-- 更新isDeleted  为  NULL -->
   <update id="updateIsDeleted" parameterType="com.jabava.pojo.hro.order.HsEmpOrdVO">
    update  hs_emp_ord_nsb_detail set is_deleted =1,
    modify_date =#{nowDate}
      where ord_nsb_detail_id not in
       <foreach collection="idList" item="item" index="index"  open= "(" close =")"  separator="," >     
        	 #{item}    
        </foreach>
        and order_id = #{orderId}
  </update>
  <!-- 批量新增更新 如果  ord_nsb_detail_id 没有就新增，如果有就更新 --> 
  <insert id="insertOrUpdateList" parameterType="list">
	  <![CDATA[
		INSERT INTO hs_emp_ord_nsb_detail
   	    (ord_nsb_detail_id,company_id, payment_month, order_id, 
      quotation_name, offer_id, prod_name, 
      item_id, item_type, bill_month, 
      sum, frequency, if_prepay, 
      bill_template_id, create_user_id, create_date, 
      update_user_id, update_date, is_deleted, 
      has_changed, auto_add, emp_relative_id,import_date) 
   	    VALUES 
   	  ]]>
		<foreach collection="list" item="item"  index="index" separator=",">
	  (
		  #{item.ordNsbDetailId,jdbcType=BIGINT},#{item.companyId,jdbcType=BIGINT},#{item.paymentMonth,jdbcType=CHAR}, #{item.orderId,jdbcType=BIGINT}, 
		  #{item.quotationName,jdbcType=VARCHAR}, 
	      #{item.offerId,jdbcType=BIGINT}, #{item.prodName,jdbcType=VARCHAR}, #{item.itemId,jdbcType=BIGINT}, 
	      #{item.itemType,jdbcType=VARCHAR},  #{item.billMonth,jdbcType=CHAR}, 
	      #{item.sum,jdbcType=DECIMAL}, 
	      #{item.frequency,jdbcType=VARCHAR}, #{item.ifPrepay,jdbcType=INTEGER},
	      #{item.billTemplateId,jdbcType=BIGINT}, #{item.createUserId,jdbcType=BIGINT}, 
	      #{item.createDate,jdbcType=TIMESTAMP}, #{item.updateUserId,jdbcType=BIGINT}, #{item.updateDate,jdbcType=TIMESTAMP}, 
	      #{item.isDeleted,jdbcType=INTEGER}, #{item.hasChanged,jdbcType=INTEGER}, #{item.autoAdd,jdbcType=INTEGER}, 
	      #{item.empRelativeId,jdbcType=BIGINT} ,#{item.importDate,jdbcType=TIMESTAMP}
         )
		</foreach>		
		ON DUPLICATE KEY UPDATE
		ord_nsb_detail_id=values(ord_nsb_detail_id),
		company_id= values(company_id),
		payment_month= values(payment_month),
		order_id= values(order_id),		
		quotation_name=values(quotation_name),
		offer_id= values(offer_id),
		prod_name=values(prod_name),		
		item_id= values(item_id),
		
		item_type=values(item_type),		
	
		bill_month=values(bill_month),
		sum= values(sum),
		
		frequency=values(frequency),
		if_prepay=values(if_prepay),
		
		bill_template_id=values(bill_template_id),
		create_user_id= values(create_user_id),
		
		create_date= values(create_date),
		update_user_id=values(update_user_id),		
		update_date= values(update_date),
		is_deleted=values(is_deleted),
		has_changed= values(has_changed),
		auto_add=values(auto_add),
		emp_relative_id=values(emp_relative_id),
		import_date=values(import_date)
		
	</insert> 
  <insert id="insertSelective" parameterType="com.jabava.pojo.hro.order.HsEmpOrdNsbDetail" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into hs_emp_ord_nsb_detail
   <trim prefix="(" suffix=")" suffixOverrides="," >
    
	 <if test="companyId != null and companyId!=''">
		  company_id,
	 </if>		
      <if test="ordNsbDetailId != null" >
        ord_nsb_detail_id,
      </if>
      <if test="paymentMonth != null" >
        payment_month,
      </if>
      <if test="orderId != null" >
        order_id,
      </if>
      <if test="quotationName != null" >
        quotation_name,
      </if>
      <if test="offerId != null" >
        offer_id,
      </if>
      <if test="prodName != null" >
        prod_name,
      </if>
      <if test="itemId != null" >
        item_id,
      </if>
      <if test="itemType != null" >
        item_type,
      </if>
      <if test="billMonth != null" >
        bill_month,
      </if>
      <if test="sum != null" >
        sum,
      </if>
      <if test="frequency != null" >
        frequency,
      </if>
      <if test="ifPrepay != null" >
        if_prepay,
      </if>
      <if test="billTemplateId != null" >
        bill_template_id,
      </if>
      <if test="createUserId != null" >
        create_user_id,
      </if>
      <if test="createDate != null" >
        create_date,
      </if>
      <if test="updateUserId != null" >
        update_user_id,
      </if>
      <if test="updateDate != null" >
        update_date,
      </if>
      <if test="isDeleted != null" >
        is_deleted,
      </if>
      <if test="hasChanged != null" >
        has_changed,
      </if>
      <if test="autoAdd != null" >
        auto_add,
      </if>
      <if test="empRelativeId != null" >
        emp_relative_id,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
       
	  <if test="companyId != null and companyId!=''">
		   #{companyId,jdbcType=BIGINT},
	  </if>
      <if test="ordNsbDetailId != null" >
        #{ordNsbDetailId,jdbcType=BIGINT},
      </if>
      <if test="paymentMonth != null" >
        #{paymentMonth,jdbcType=CHAR},
      </if>
      <if test="orderId != null" >
        #{orderId,jdbcType=BIGINT},
      </if>
      <if test="quotationName != null" >
        #{quotationName,jdbcType=VARCHAR},
      </if>
      <if test="offerId != null" >
        #{offerId,jdbcType=BIGINT},
      </if>
      <if test="prodName != null" >
        #{prodName,jdbcType=VARCHAR},
      </if>
      <if test="itemId != null" >
        #{itemId,jdbcType=BIGINT},
      </if>
      <if test="itemType != null" >
        #{itemType,jdbcType=VARCHAR},
      </if>
      <if test="billMonth != null" >
        #{billMonth,jdbcType=CHAR},
      </if>
      <if test="sum != null" >
        #{sum,jdbcType=DECIMAL},
      </if>
      <if test="frequency != null" >
        #{frequency,jdbcType=VARCHAR},
      </if>
      <if test="ifPrepay != null" >
        #{ifPrepay,jdbcType=INTEGER},
      </if>
      <if test="billTemplateId != null" >
        #{billTemplateId,jdbcType=BIGINT},
      </if>
      <if test="createUserId != null" >
        #{createUserId,jdbcType=BIGINT},
      </if>
      <if test="createDate != null" >
        #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateUserId != null" >
        #{updateUserId,jdbcType=BIGINT},
      </if>
      <if test="updateDate != null" >
        #{updateDate,jdbcType=TIMESTAMP},
      </if>
      <if test="isDeleted != null" >
        #{isDeleted,jdbcType=INTEGER},
      </if>
      <if test="hasChanged != null" >
        #{hasChanged,jdbcType=INTEGER},
      </if>
      <if test="autoAdd != null" >
        #{autoAdd,jdbcType=INTEGER},
      </if>
      <if test="empRelativeId != null" >
        #{empRelativeId,jdbcType=BIGINT},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.jabava.pojo.hro.order.HsEmpOrdNsbDetail" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update hs_emp_ord_nsb_detail
    <set >     
	 <if test="companyId != null and companyId!=''">
		company_id =#{companyId,jdbcType=BIGINT},
	  </if>
      <if test="orderId != null" >
        order_id = #{orderId,jdbcType=BIGINT},
      </if>
      <if test="quotationName != null" >
        quotation_name = #{quotationName,jdbcType=VARCHAR},
      </if>
      <if test="offerId != null" >
        offer_id = #{offerId,jdbcType=BIGINT},
      </if>
      <if test="prodName != null" >
        prod_name = #{prodName,jdbcType=VARCHAR},
      </if>
      <if test="itemId != null" >
        item_id = #{itemId,jdbcType=BIGINT},
      </if>
      <if test="itemType != null" >
        item_type = #{itemType,jdbcType=VARCHAR},
      </if>
      <if test="billMonth != null" >
        bill_month = #{billMonth,jdbcType=CHAR},
      </if>
      <if test="sum != null" >
        sum = #{sum,jdbcType=DECIMAL},
      </if>
      <if test="frequency != null" >
        frequency = #{frequency,jdbcType=VARCHAR},
      </if>
      <if test="ifPrepay != null" >
        if_prepay = #{ifPrepay,jdbcType=INTEGER},
      </if>
      <if test="billTemplateId != null" >
        bill_template_id = #{billTemplateId,jdbcType=BIGINT},
      </if>
      <if test="createUserId != null" >
        create_user_id = #{createUserId,jdbcType=BIGINT},
      </if>
      <if test="createDate != null" >
        create_date = #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateUserId != null" >
        update_user_id = #{updateUserId,jdbcType=BIGINT},
      </if>
      <if test="updateDate != null" >
        update_date = #{updateDate,jdbcType=TIMESTAMP},
      </if>
      <if test="isDeleted != null" >
        is_deleted = #{isDeleted,jdbcType=INTEGER},
      </if>
      <if test="hasChanged != null" >
        has_changed = #{hasChanged,jdbcType=INTEGER},
      </if>
      <if test="autoAdd != null" >
        auto_add = #{autoAdd,jdbcType=INTEGER},
      </if>
      <if test="empRelativeId != null" >
        emp_relative_id = #{empRelativeId,jdbcType=BIGINT},
      </if>
      </set>
    where ord_nsb_detail_id = #{ordNsbDetailId,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.jabava.pojo.hro.order.HsEmpOrdNsbDetail" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update hs_emp_ord_nsb_detail
    set   
      company_id =#{companyId,jdbcType=BIGINT},
      order_id = #{orderId,jdbcType=BIGINT},
      quotation_name = #{quotationName,jdbcType=VARCHAR},
      offer_id = #{offerId,jdbcType=BIGINT},
      prod_name = #{prodName,jdbcType=VARCHAR},
      item_id = #{itemId,jdbcType=BIGINT},
      item_type = #{itemType,jdbcType=VARCHAR},
      bill_month = #{billMonth,jdbcType=CHAR},
      sum = #{sum,jdbcType=DECIMAL},
      frequency = #{frequency,jdbcType=VARCHAR},
      if_prepay = #{ifPrepay,jdbcType=INTEGER},
      bill_template_id = #{billTemplateId,jdbcType=BIGINT},
      create_user_id = #{createUserId,jdbcType=BIGINT},
      create_date = #{createDate,jdbcType=TIMESTAMP},
      update_user_id = #{updateUserId,jdbcType=BIGINT},
      update_date = #{updateDate,jdbcType=TIMESTAMP},
      is_deleted = #{isDeleted,jdbcType=INTEGER},
      has_changed = #{hasChanged,jdbcType=INTEGER},
      auto_add = #{autoAdd,jdbcType=INTEGER},
      emp_relative_id = #{empRelativeId,jdbcType=BIGINT}
    where ord_nsb_detail_id = #{ordNsbDetailId,jdbcType=BIGINT}
  </update>
</mapper>