<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jabava.dao.employee.EhrPositionMapper" >
  <resultMap id="BaseResultMap" type="com.jabava.pojo.employee.EhrPosition" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="position_id" property="positionId" jdbcType="BIGINT" />
    <result column="person_id" property="personId" jdbcType="BIGINT" />
    <result column="position_name" property="positionName" jdbcType="BIGINT" />
    <result column="employee_number" property="employeeNumber" jdbcType="VARCHAR" />
    <result column="department_id" property="departmentId" jdbcType="BIGINT" />
    <result column="level_id" property="levelId" jdbcType="BIGINT" />
    <result column="key_point" property="keyPoint" jdbcType="INTEGER" />
    <result column="nature_of_labor" property="natureOfLabor" jdbcType="BIGINT" />
    <result column="report_id" property="reportId" jdbcType="BIGINT" />
    <result column="cost_center_id" property="costCenterId" jdbcType="BIGINT" />
    <result column="create_user_id" property="createUserId" jdbcType="BIGINT" />
    <result column="create_date" property="createDate" jdbcType="TIMESTAMP" />
    <result column="update_user_id" property="updateUserId" jdbcType="BIGINT" />
    <result column="update_date" property="updateDate" jdbcType="TIMESTAMP" />
    <result column="remark" property="remark" jdbcType="VARCHAR" />
    <result column="is_deleted" property="isDeleted" jdbcType="INTEGER" />
  </resultMap>
  <sql id="Base_Column_List" >
     position_id, person_id, employee_number, position_name, department_id, level_id, 
    key_point, nature_of_labor, report_id, cost_center_id, create_user_id, create_date, 
    update_user_id, update_date, remark, is_deleted
  </sql>
  
  <resultMap id="PositionResult" type="com.jabava.pojo.employee.EhrPositionVO"  extends="BaseResultMap">
		<association property="reportPerson" column="report_id" javaType="com.jabava.pojo.manage.EhrPerson" resultMap="ReportPersonResultMap"/>
 		<association property="person" column="person_id" javaType="com.jabava.pojo.manage.EhrPerson" resultMap="PersonResultMap"/>
  		<association property="department" column="department_id" javaType="com.jabava.pojo.manage.EhrOrganization" resultMap="OrgResultMap"/>
 
  </resultMap>
    <!--  -->
   <resultMap id="PersonResultMap" type="com.jabava.pojo.manage.EhrPerson" >
    <!--
      WARNING - @mbggenerated 
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Dec 22 13:34:15 CST 2015.
    -->
    <id column="person_id" property="personId" jdbcType="BIGINT" />
    <result column="company_id" property="companyId" jdbcType="BIGINT" />
    <result column="organization_id" property="organizationId" jdbcType="BIGINT" />
    <result column="post_id" property="postId" jdbcType="BIGINT" />
    <result column="cost_id" property="costId" jdbcType="BIGINT" />
    <result column="job_number" property="jobNumber" jdbcType="VARCHAR" />
    <result column="employee_name" property="employeeName" jdbcType="VARCHAR" />
  </resultMap>
  
  <!-- 汇报人 -->
   <resultMap id="ReportPersonResultMap" type="com.jabava.pojo.manage.EhrPerson" >
    <!--
      WARNING - @mbggenerated 
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Dec 22 13:34:15 CST 2015.
    -->
    <id column="person_id" property="personId" jdbcType="BIGINT" />
    <result column="company_id" property="companyId" jdbcType="BIGINT" />
    <result column="organization_id" property="organizationId" jdbcType="BIGINT" />
    <result column="post_id" property="postId" jdbcType="BIGINT" />
    <result column="cost_id" property="costId" jdbcType="BIGINT" />
    <result column="job_number" property="jobNumber" jdbcType="VARCHAR" />
    <result column="employee_name" property="employeeName" jdbcType="VARCHAR" />
  </resultMap>
  <!-- 部门 -->
  	<resultMap id="OrgResultMap" type="com.jabava.pojo.manage.EhrOrganization">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Tue Dec 22 
			13:34:15 CST 2015. -->
		<id column="organization_id" property="organizationId" jdbcType="BIGINT" />
		<result column="company_id" property="companyId" jdbcType="BIGINT" />
		<result column="organization_code" property="organizationCode"
			jdbcType="VARCHAR" />
		<result column="total_organization_code" property="totalOrganizationCode"
			jdbcType="VARCHAR" />
		<result column="organization_name" property="organizationName"
			jdbcType="VARCHAR" />
		<result column="organization_level" property="organizationLevel"
			jdbcType="INTEGER" />
		<result column="parent_id" property="parentId" jdbcType="BIGINT" />
		<result column="memo" property="memo" jdbcType="VARCHAR" />
		<result column="create_user_id" property="createUserId"
			jdbcType="BIGINT" />
		<result column="create_user_name" property="createUserName"
			jdbcType="VARCHAR" />
		<result column="create_date" property="createDate" jdbcType="TIMESTAMP" />
		<result column="last_modify_user_id" property="lastModifyUserId"
			jdbcType="BIGINT" />
		<result column="last_modify_user_name" property="lastModifyUserName"
			jdbcType="VARCHAR" />
		<result column="last_modify_date" property="lastModifyDate"
			jdbcType="TIMESTAMP" />
		<result column="sort" property="sort"
			jdbcType="INTEGER" />
	</resultMap>
  <!-- 根据personId获取岗位信息 -->
    <select id="selectByPersonId" resultMap="PositionResult" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    ehr_position.*,
    p.job_number as job_number, p.company_id as company_id, r.employee_name as employee_name,
    o.organization_name as organization_name
    from ehr_position
    left join ehr_person p on ehr_position.person_id = p.person_id
    left join ehr_person r on ehr_position.report_id = r.person_id
    left join ehr_organization o on ehr_position.department_id = o.organization_id
    where ehr_position.person_id = #{personId,jdbcType=BIGINT}
    and ehr_position.is_deleted=0
  </select>
  <!-- 根据公司ID和员工ID查询岗位 -->
  <select id="getPositionByPersonIdAndCompanyId" resultMap="BaseResultMap" parameterType="com.jabava.pojo.manage.EhrPerson">
  SELECT
	ehr_position.*
	FROM
	ehr_position
	LEFT JOIN ehr_person p ON ehr_position.person_id = p.person_id
	WHERE
	ehr_position.person_id = #{personId,jdbcType=BIGINT}
	AND ehr_position.is_deleted = 0
	AND p.company_id = #{companyId,jdbcType=BIGINT}
  </select>
  
    <!-- 根据公司ID和工号查询岗位 -->
  <select id="getPositionByEmployeeNumberAndCompanyId" resultMap="BaseResultMap" parameterType="com.jabava.pojo.manage.EhrPerson">
  SELECT
	ehr_position.*
	FROM
	ehr_position
	LEFT JOIN ehr_person p ON ehr_position.person_id = p.person_id
	WHERE
	 ehr_position.is_deleted = 0
	AND p.company_id = #{companyId,jdbcType=BIGINT}
	AND ehr_position.employee_number = #{jobNumber,jdbcType=VARCHAR}
	
  </select>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from ehr_position
    where position_id = #{positionId,jdbcType=BIGINT}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from ehr_position
    where position_id = #{positionId,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.jabava.pojo.employee.EhrPosition" >
     insert into ehr_position (position_id, person_id, employee_number, 
      position_name, department_id, level_id, 
      key_point, nature_of_labor, report_id, 
      cost_center_id, create_user_id, create_date, 
      update_user_id, update_date, remark, 
      is_deleted)
    values (#{positionId,jdbcType=BIGINT}, #{personId,jdbcType=BIGINT}, #{employeeNumber,jdbcType=VARCHAR}, 
      #{positionName,jdbcType=BIGINT}, #{departmentId,jdbcType=BIGINT}, #{levelId,jdbcType=BIGINT}, 
      #{keyPoint,jdbcType=INTEGER}, #{natureOfLabor,jdbcType=BIGINT}, #{reportId,jdbcType=BIGINT}, 
      #{costCenterId,jdbcType=BIGINT}, #{createUserId,jdbcType=BIGINT}, #{createDate,jdbcType=TIMESTAMP}, 
      #{updateUserId,jdbcType=BIGINT}, #{updateDate,jdbcType=TIMESTAMP}, #{remark,jdbcType=VARCHAR}, 
      #{isDeleted,jdbcType=INTEGER})
  </insert>
  <insert id="insertSelective" parameterType="com.jabava.pojo.employee.EhrPosition" >
     <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into ehr_position
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="positionId != null" >
        position_id,
      </if>      
      <if test="personId != null" >
        person_id,
      </if>
       <if test="employeeNumber != null" >
        employee_number,
      </if>
      <if test="positionName != null" >
        position_name,
      </if>
      <if test="departmentId != null" >
        department_id,
      </if>
      <if test="levelId != null" >
        level_id,
      </if>
      <if test="keyPoint != null" >
        key_point,
      </if>
      <if test="natureOfLabor != null" >
        nature_of_labor,
      </if>
      <if test="reportId != null" >
        report_id,
      </if>
      <if test="costCenterId != null" >
        cost_center_id,
      </if>
      <if test="createUserId != null" >
        create_user_id,
      </if>
      <if test="createDate != null" >
        create_date,
      </if>
      <if test="updateUserId != null" >
        update_user_id,
      </if>
      <if test="updateDate != null" >
        update_date,
      </if>
      <if test="remark != null" >
        remark,
      </if>
      <if test="isDeleted != null" >
        is_deleted,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="positionId != null" >
        #{positionId,jdbcType=BIGINT},
      </if>
      <if test="personId != null" >
        #{personId,jdbcType=BIGINT},
      </if>
       <if test="employeeNumber != null" >
        #{employeeNumber,jdbcType=VARCHAR},
      </if>
      <if test="positionName != null" >
        #{positionName,jdbcType=BIGINT},
      </if>
      <if test="departmentId != null" >
        #{departmentId,jdbcType=BIGINT},
      </if>
      <if test="levelId != null" >
        #{levelId,jdbcType=BIGINT},
      </if>
      <if test="keyPoint != null" >
        #{keyPoint,jdbcType=INTEGER},
      </if>
      <if test="natureOfLabor != null" >
        #{natureOfLabor,jdbcType=BIGINT},
      </if>
      <if test="reportId != null" >
        #{reportId,jdbcType=BIGINT},
      </if>
      <if test="costCenterId != null" >
        #{costCenterId,jdbcType=BIGINT},
      </if>
      <if test="createUserId != null" >
        #{createUserId,jdbcType=BIGINT},
      </if>
      <if test="createDate != null" >
        #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateUserId != null" >
        #{updateUserId,jdbcType=BIGINT},
      </if>
      <if test="updateDate != null" >
        #{updateDate,jdbcType=TIMESTAMP},
      </if>
      <if test="remark != null" >
        #{remark,jdbcType=VARCHAR},
      </if>
      <if test="isDeleted != null" >
        #{isDeleted,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.jabava.pojo.employee.EhrPosition" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
     update ehr_position
    <set >
      <if test="personId != null" >
        person_id = #{personId,jdbcType=BIGINT},
      </if>
        <if test="employeeNumber != null" >
        employee_number = #{employeeNumber,jdbcType=VARCHAR},
      </if>
      <if test="positionName != null" >
        position_name = #{positionName,jdbcType=BIGINT},
      </if>
      <if test="departmentId != null" >
        department_id = #{departmentId,jdbcType=BIGINT},
      </if>
      <if test="levelId != null" >
        level_id = #{levelId,jdbcType=BIGINT},
      </if>
      <if test="keyPoint != null" >
        key_point = #{keyPoint,jdbcType=INTEGER},
      </if>
      <if test="natureOfLabor != null" >
        nature_of_labor = #{natureOfLabor,jdbcType=BIGINT},
      </if>
      <if test="reportId != null" >
        report_id = #{reportId,jdbcType=BIGINT},
      </if>
      <if test="costCenterId != null" >
        cost_center_id = #{costCenterId,jdbcType=BIGINT},
      </if>
      <if test="createUserId != null" >
        create_user_id = #{createUserId,jdbcType=BIGINT},
      </if>
      <if test="createDate != null" >
        create_date = #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateUserId != null" >
        update_user_id = #{updateUserId,jdbcType=BIGINT},
      </if>
      <if test="updateDate != null" >
        update_date = #{updateDate,jdbcType=TIMESTAMP},
      </if>
      <if test="remark != null" >
        remark = #{remark,jdbcType=VARCHAR},
      </if>
      <if test="isDeleted != null" >
        is_deleted = #{isDeleted,jdbcType=INTEGER},
      </if>
    </set>
    where position_id = #{positionId,jdbcType=BIGINT}
  </update>
  <!-- 根据personId更新 -->
   <update id="updateByPersonId" parameterType="com.jabava.pojo.employee.EhrPosition" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
     update ehr_position
    <set >
      <if test="personId != null" >
        person_id = #{personId,jdbcType=BIGINT},
      </if>
        <if test="employeeNumber != null" >
        employee_number = #{employeeNumber,jdbcType=VARCHAR},
      </if>
      <if test="positionName != null" >
        position_name = #{positionName,jdbcType=BIGINT},
      </if>
      <if test="departmentId != null" >
        department_id = #{departmentId,jdbcType=BIGINT},
      </if>
      <if test="levelId != null" >
        level_id = #{levelId,jdbcType=BIGINT},
      </if>
      <if test="keyPoint != null" >
        key_point = #{keyPoint,jdbcType=INTEGER},
      </if>
      <if test="natureOfLabor != null" >
        nature_of_labor = #{natureOfLabor,jdbcType=BIGINT},
      </if>
      <if test="reportId != null" >
        report_id = #{reportId,jdbcType=BIGINT},
      </if>
      <if test="costCenterId != null" >
        cost_center_id = #{costCenterId,jdbcType=BIGINT},
      </if>
      <if test="createUserId != null" >
        create_user_id = #{createUserId,jdbcType=BIGINT},
      </if>
      <if test="createDate != null" >
        create_date = #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateUserId != null" >
        update_user_id = #{updateUserId,jdbcType=BIGINT},
      </if>
      <if test="updateDate != null" >
        update_date = #{updateDate,jdbcType=TIMESTAMP},
      </if>
      <if test="remark != null" >
        remark = #{remark,jdbcType=VARCHAR},
      </if>
      <if test="isDeleted != null" >
        is_deleted = #{isDeleted,jdbcType=INTEGER},
      </if>
    </set>
    where  person_id = #{personId,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.jabava.pojo.employee.EhrPosition" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
     update ehr_position
    set person_id = #{personId,jdbcType=BIGINT},
      employee_number = #{employeeNumber,jdbcType=VARCHAR},
      position_name = #{positionName,jdbcType=BIGINT},
      department_id = #{departmentId,jdbcType=BIGINT},
      level_id = #{levelId,jdbcType=BIGINT},
      key_point = #{keyPoint,jdbcType=INTEGER},
      nature_of_labor = #{natureOfLabor,jdbcType=BIGINT},
      report_id = #{reportId,jdbcType=BIGINT},
      cost_center_id = #{costCenterId,jdbcType=BIGINT},
      create_user_id = #{createUserId,jdbcType=BIGINT},
      create_date = #{createDate,jdbcType=TIMESTAMP},
      update_user_id = #{updateUserId,jdbcType=BIGINT},
      update_date = #{updateDate,jdbcType=TIMESTAMP},
      remark = #{remark,jdbcType=VARCHAR},
      is_deleted = #{isDeleted,jdbcType=INTEGER}
    where position_id = #{positionId,jdbcType=BIGINT}
  </update>
</mapper>