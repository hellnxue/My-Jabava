<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jabava.dao.employee.EhrJobpostMapper" >
  <resultMap id="BaseResultMap" type="com.jabava.pojo.employee.EhrJobpost" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 13 19:57:44 CST 2016.
    -->
    <id column="post_id" property="postId" jdbcType="BIGINT" />
    <result column="person_id" property="personId" jdbcType="BIGINT" />
    <result column="source_department" property="sourceDepartment" jdbcType="VARCHAR" />
    <result column="source_post" property="sourcePost" jdbcType="VARCHAR" />
    <result column="source_rank" property="sourceRank" jdbcType="VARCHAR" />
    <result column="source_report" property="sourceReport" jdbcType="VARCHAR" />
    <result column="source_location" property="sourceLocation" jdbcType="VARCHAR" />
    <result column="source_long" property="sourceLong" jdbcType="VARCHAR" />
    <result column="source_cost" property="sourceCost" jdbcType="VARCHAR" />
    <result column="new_department" property="newDepartment" jdbcType="VARCHAR" />
    <result column="new_post" property="newPost" jdbcType="VARCHAR" />
    <result column="new_rank" property="newRank" jdbcType="VARCHAR" />
    <result column="new_report" property="newReport" jdbcType="VARCHAR" />
    <result column="new_location" property="newLocation" jdbcType="VARCHAR" />
    <result column="new_cost" property="newCost" jdbcType="VARCHAR" />
    <result column="cause" property="cause" jdbcType="VARCHAR" />
    <result column="new_date" property="newDate" jdbcType="DATE" />
    <result column="is_change_salary" property="isChangeSalary" jdbcType="TINYINT" />
    <result column="create_user_id" property="createUserId" jdbcType="BIGINT" />
    <result column="create_user_name" property="createUserName" jdbcType="VARCHAR" />
    <result column="create_date" property="createDate" jdbcType="TIMESTAMP" />
    <result column="last_modify_user_id" property="lastModifyUserId" jdbcType="BIGINT" />
    <result column="last_modify_user_name" property="lastModifyUserName" jdbcType="VARCHAR" />
    <result column="last_modify_date" property="lastModifyDate" jdbcType="TIMESTAMP" />
    <result column="memo" property="memo" jdbcType="VARCHAR" />
    <result column="is_change" property="isChange" jdbcType="TINYINT" />
    <result column="is_deleted" property="isDeleted" jdbcType="INTEGER" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 13 19:57:44 CST 2016.
    -->
    post_id, person_id, source_department, source_post, source_rank, source_report, source_location, 
    source_long, source_cost, new_department, new_post, new_rank, new_report, new_location, 
    new_cost, cause, new_date, is_change_salary, create_user_id, create_user_name, create_date, 
    last_modify_user_id, last_modify_user_name, last_modify_date, memo, is_change,is_deleted
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 13 19:57:44 CST 2016.
    -->
    select 
    <include refid="Base_Column_List" />
    from ehr_jobpost
    where post_id = #{postId,jdbcType=BIGINT}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 13 19:57:44 CST 2016.
    -->
    delete from ehr_jobpost
    where post_id = #{postId,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.jabava.pojo.employee.EhrJobpost" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 13 19:57:44 CST 2016.
    -->
    insert into ehr_jobpost (post_id, person_id, source_department, 
      source_post, source_rank, source_report, 
      source_location, source_long, source_cost, 
      new_department, new_post, new_rank, 
      new_report, new_location, new_cost, 
      cause, new_date, is_change_salary, 
      create_user_id, create_user_name, create_date, 
      last_modify_user_id, last_modify_user_name, last_modify_date, 
      memo, is_change,is_deleted)
    values (#{postId,jdbcType=BIGINT}, #{personId,jdbcType=BIGINT}, #{sourceDepartment,jdbcType=VARCHAR}, 
      #{sourcePost,jdbcType=VARCHAR}, #{sourceRank,jdbcType=VARCHAR}, #{sourceReport,jdbcType=VARCHAR}, 
      #{sourceLocation,jdbcType=VARCHAR}, #{sourceLong,jdbcType=DATE}, #{sourceCost,jdbcType=VARCHAR}, 
      #{newDepartment,jdbcType=VARCHAR}, #{newPost,jdbcType=VARCHAR}, #{newRank,jdbcType=VARCHAR}, 
      #{newReport,jdbcType=VARCHAR}, #{newLocation,jdbcType=VARCHAR}, #{newCost,jdbcType=VARCHAR}, 
      #{cause,jdbcType=VARCHAR}, #{newDate,jdbcType=DATE}, #{isChangeSalary,jdbcType=TINYINT}, 
      #{createUserId,jdbcType=BIGINT}, #{createUserName,jdbcType=VARCHAR}, #{createDate,jdbcType=TIMESTAMP}, 
      #{lastModifyUserId,jdbcType=BIGINT}, #{lastModifyUserName,jdbcType=VARCHAR}, #{lastModifyDate,jdbcType=TIMESTAMP}, 
      #{memo,jdbcType=VARCHAR}, #{isChange,jdbcType=TINYINT}, #{isDeleted,jdbcType=INTEGER})
  </insert>
  <insert id="insertSelective" parameterType="com.jabava.pojo.employee.EhrJobpost" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 13 19:57:44 CST 2016.
    -->
    insert into ehr_jobpost
    <trim prefix="(" suffix=")" suffixOverrides="," >     
      <if test="personId != null" >
        person_id,
      </if>
      <if test="sourceDepartment != null and  sourceDepartment!='' " >
        source_department,
      </if>
      <if test="sourcePost != null and  sourcePost!='' " >
        source_post,
      </if>
      <if test="sourceRank != null and  sourceRank!=''" >
        source_rank,
      </if>
      <if test="sourceReport != null and  sourceReport!=''" >
        source_report,
      </if>
      <if test="sourceLocation != null and  sourceLocation!=''" >
        source_location,
      </if>
      <if test="sourceLong != null and sourceLong!=''" >
        source_long,
      </if>
      <if test="sourceCost != null and  sourceCost!=''" >
        source_cost,
      </if>
      <if test="newDepartment != null and  newDepartment!=''" >
        new_department,
      </if>
      <if test="newPost != null and  newPost !=''" >
        new_post,
      </if>
      <if test="newRank != null and  newRank !=''" >
        new_rank,
      </if>
      <if test="newReport != null and  newReport !=''" >
        new_report,
      </if>
      <if test="newLocation != null and  newLocation!=''" >
        new_location,
      </if>
      <if test="newCost != null and  newCost!=''" >
        new_cost,
      </if>
      <if test="cause != null and  cause!=''" >
        cause,
      </if>
      <if test="newDate != null  and  newDate!=''" >
        new_date,
      </if>
      <if test="isChangeSalary != null and  isChangeSalary!=''" >
        is_change_salary,
      </if>
      <if test="createUserId != null" >
        create_user_id,
      </if>
      <if test="createUserName != null" >
        create_user_name,
      </if>
      <if test="createDate != null" >
        create_date,
      </if>
      <if test="lastModifyUserId != null" >
        last_modify_user_id,
      </if>
      <if test="lastModifyUserName != null" >
        last_modify_user_name,
      </if>
      <if test="lastModifyDate != null" >
        last_modify_date,
      </if>
      <if test="memo != null and memo!=''" >
        memo,
      </if>
      <if test="isChange != null" >
        is_change,
      </if>
      <if test="isDeleted != null" >
        is_deleted,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >     
      <if test="personId != null " >
        #{personId,jdbcType=BIGINT},
      </if>
      <if test="sourceDepartment != null and  sourceDepartment !=''" >
        #{sourceDepartment,jdbcType=VARCHAR},
      </if>
      <if test="sourcePost != null  and  sourcePost !=''" >
        #{sourcePost,jdbcType=VARCHAR},
      </if>
      <if test="sourceRank != null and  sourceRank !=''" >
        #{sourceRank,jdbcType=VARCHAR},
      </if>
      <if test="sourceReport != null and  sourceReport !=''" >
        #{sourceReport,jdbcType=VARCHAR},
      </if>
      <if test="sourceLocation != null and  sourceLocation !=''" >
        #{sourceLocation,jdbcType=VARCHAR},
      </if>
      <if test="sourceLong != null and  sourceLong !=''" >
        #{sourceLong,jdbcType=DATE},
      </if>
      <if test="sourceCost != null and  sourceCost !=''" >
        #{sourceCost,jdbcType=VARCHAR},
      </if>
      <if test="newDepartment != null  and  newDepartment !=''" >
        #{newDepartment,jdbcType=VARCHAR},
      </if>
      <if test="newPost != null  and  newPost !=''" >
        #{newPost,jdbcType=VARCHAR},
      </if>
      <if test="newRank != null and  newRank !=''" >
        #{newRank,jdbcType=VARCHAR},
      </if>
      <if test="newReport != null and  newReport !=''" >
        #{newReport,jdbcType=VARCHAR},
      </if>
      <if test="newLocation != null and  newLocation !=''" >
        #{newLocation,jdbcType=VARCHAR},
      </if>
      <if test="newCost != null and  newCost !=''" >
        #{newCost,jdbcType=VARCHAR},
      </if>
      <if test="cause != null  and  cause !=''" >
        #{cause,jdbcType=VARCHAR},
      </if>
      <if test="newDate != null and  newDate !=''" >
        #{newDate,jdbcType=DATE},
      </if>
      <if test="isChangeSalary != null and  isChangeSalary !=''" >
        #{isChangeSalary,jdbcType=TINYINT},
      </if>
      <if test="createUserId != null" >
        #{createUserId,jdbcType=BIGINT},
      </if>
      <if test="createUserName != null" >
        #{createUserName,jdbcType=VARCHAR},
      </if>
      <if test="createDate != null" >
        #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="lastModifyUserId != null" >
        #{lastModifyUserId,jdbcType=BIGINT},
      </if>
      <if test="lastModifyUserName != null" >
        #{lastModifyUserName,jdbcType=VARCHAR},
      </if>
      <if test="lastModifyDate != null" >
        #{lastModifyDate,jdbcType=TIMESTAMP},
      </if>
      <if test="memo != null and  memo !=''" >
        #{memo,jdbcType=VARCHAR},
      </if>
      <if test="isChange != null and  isChange !=''" >
        #{isChange,jdbcType=TINYINT},
      </if>
       <if test="isDeleted != null" >
        #{isDeleted,jdbcType=INTEGER},
      </if>
    </trim>   
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.jabava.pojo.employee.EhrJobpost" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 13 19:57:44 CST 2016.
    -->
    update ehr_jobpost
    <set >
      <if test="personId != null" >
        person_id = #{personId,jdbcType=BIGINT},
      </if>
      <if test="sourceDepartment != null" >
        source_department = #{sourceDepartment,jdbcType=VARCHAR},
      </if>
      <if test="sourcePost != null" >
        source_post = #{sourcePost,jdbcType=VARCHAR},
      </if>
      <if test="sourceRank != null" >
        source_rank = #{sourceRank,jdbcType=VARCHAR},
      </if>
      <if test="sourceReport != null" >
        source_report = #{sourceReport,jdbcType=VARCHAR},
      </if>
      <if test="sourceLocation != null" >
        source_location = #{sourceLocation,jdbcType=VARCHAR},
      </if>
      <if test="sourceLong != null and sourceLong!=''" >
        source_long = #{sourceLong,jdbcType=VARCHAR},
      </if>
      <if test="sourceCost != null" >
        source_cost = #{sourceCost,jdbcType=VARCHAR},
      </if>
      <if test="newDepartment != null" >
        new_department = #{newDepartment,jdbcType=VARCHAR},
      </if>
      <if test="newPost != null" >
        new_post = #{newPost,jdbcType=VARCHAR},
      </if>
      <if test="newRank != null" >
        new_rank = #{newRank,jdbcType=VARCHAR},
      </if>
      <if test="newReport != null" >
        new_report = #{newReport,jdbcType=VARCHAR},
      </if>
      <if test="newLocation != null" >
        new_location = #{newLocation,jdbcType=VARCHAR},
      </if>
      <if test="newCost != null" >
        new_cost = #{newCost,jdbcType=VARCHAR},
      </if>
      <if test="cause != null" >
        cause = #{cause,jdbcType=VARCHAR},
      </if>
      <if test="newDate != null" >
        new_date = #{newDate,jdbcType=DATE},
      </if>
      <if test="isChangeSalary != null" >
        is_change_salary = #{isChangeSalary,jdbcType=TINYINT},
      </if>
      <if test="createUserId != null" >
        create_user_id = #{createUserId,jdbcType=BIGINT},
      </if>
      <if test="createUserName != null" >
        create_user_name = #{createUserName,jdbcType=VARCHAR},
      </if>
      <if test="createDate != null" >
        create_date = #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="lastModifyUserId != null" >
        last_modify_user_id = #{lastModifyUserId,jdbcType=BIGINT},
      </if>
      <if test="lastModifyUserName != null" >
        last_modify_user_name = #{lastModifyUserName,jdbcType=VARCHAR},
      </if>
      <if test="lastModifyDate != null" >
        last_modify_date = #{lastModifyDate,jdbcType=TIMESTAMP},
      </if>
      <if test="memo != null" >
        memo = #{memo,jdbcType=VARCHAR},
      </if>
      <if test="isChange != null" >
        is_change = #{isChange,jdbcType=TINYINT},
      </if>
       <if test="isDeleted != null" >
        is_deleted = #{isDeleted,jdbcType=INTEGER},
      </if>
    </set>
    where post_id = #{postId,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.jabava.pojo.employee.EhrJobpost" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 13 19:57:44 CST 2016.
    -->
    update ehr_jobpost
    set person_id = #{personId,jdbcType=BIGINT},
      source_department = #{sourceDepartment,jdbcType=VARCHAR},
      source_post = #{sourcePost,jdbcType=VARCHAR},
      source_rank = #{sourceRank,jdbcType=VARCHAR},
      source_report = #{sourceReport,jdbcType=VARCHAR},
      source_location = #{sourceLocation,jdbcType=VARCHAR},
      source_long = #{sourceLong,jdbcType=VARCHAR},
      source_cost = #{sourceCost,jdbcType=VARCHAR},
      new_department = #{newDepartment,jdbcType=VARCHAR},
      new_post = #{newPost,jdbcType=VARCHAR},
      new_rank = #{newRank,jdbcType=VARCHAR},
      new_report = #{newReport,jdbcType=VARCHAR},
      new_location = #{newLocation,jdbcType=VARCHAR},
      new_cost = #{newCost,jdbcType=VARCHAR},
      cause = #{cause,jdbcType=VARCHAR},
      new_date = #{newDate,jdbcType=DATE},
      is_change_salary = #{isChangeSalary,jdbcType=TINYINT},
      create_user_id = #{createUserId,jdbcType=BIGINT},
      create_user_name = #{createUserName,jdbcType=VARCHAR},
      create_date = #{createDate,jdbcType=TIMESTAMP},
      last_modify_user_id = #{lastModifyUserId,jdbcType=BIGINT},
      last_modify_user_name = #{lastModifyUserName,jdbcType=VARCHAR},
      last_modify_date = #{lastModifyDate,jdbcType=TIMESTAMP},
      memo = #{memo,jdbcType=VARCHAR},
      is_change = #{isChange,jdbcType=TINYINT}
      is_deleted = #{isDeleted,jdbcType=INTEGER}
     
    where post_id = #{postId,jdbcType=BIGINT}
  </update>
  <resultMap id="PostResult" type="com.jabava.pojo.employee.EhrJobpostVO"  extends="BaseResultMap">
 		<association property="reportPersonNew" column="new_report" javaType="com.jabava.pojo.manage.EhrPerson" resultMap="PersonResultMap"/>
  		<association property="departmentNew" column="new_department" javaType="com.jabava.pojo.manage.EhrOrganization" resultMap="OrgResultMap"/>
     	<association property="reportPersonSource" column="source_report" javaType="com.jabava.pojo.manage.EhrPerson" resultMap="SourcePersonResultMap"/>
  		<association property="departmentSource" column="source_department" javaType="com.jabava.pojo.manage.EhrOrganization" resultMap="SourceOrgResultMap"/>
   
 
  </resultMap> 
   <resultMap id="PersonResultMap" type="com.jabava.pojo.manage.EhrPerson" >
    <!--
      WARNING - @mbggenerated 
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Dec 22 13:34:15 CST 2015.
    -->
    <id column="person_id" property="personId" jdbcType="BIGINT" />
    <result column="company_id" property="companyId" jdbcType="BIGINT" />
    <result column="organization_id" property="organizationId" jdbcType="BIGINT" />
    <result column="post_id" property="postId" jdbcType="BIGINT" />
    <result column="cost_id" property="costId" jdbcType="BIGINT" />
    <result column="job_number" property="jobNumber" jdbcType="VARCHAR" />
    <result column="new_employee_name" property="employeeName" jdbcType="VARCHAR" />
  </resultMap>
  
  <!-- 汇报人 -->
   <resultMap id="ReportPersonResultMap" type="com.jabava.pojo.manage.EhrPerson" >
    <!--
      WARNING - @mbggenerated 
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Dec 22 13:34:15 CST 2015.
    -->
    <id column="person_id" property="personId" jdbcType="BIGINT" />
    <result column="company_id" property="companyId" jdbcType="BIGINT" />
    <result column="organization_id" property="organizationId" jdbcType="BIGINT" />
    <result column="post_id" property="postId" jdbcType="BIGINT" />
    <result column="cost_id" property="costId" jdbcType="BIGINT" />
    <result column="job_number" property="jobNumber" jdbcType="VARCHAR" />
    <result column="new_employee_name" property="employeeName" jdbcType="VARCHAR" />
  </resultMap>
  <!-- 部门 -->
  	<resultMap id="OrgResultMap" type="com.jabava.pojo.manage.EhrOrganization">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Tue Dec 22 
			13:34:15 CST 2015. -->
		<id column="organization_id" property="organizationId" jdbcType="BIGINT" />
		<result column="company_id" property="companyId" jdbcType="BIGINT" />
		<result column="organization_code" property="organizationCode"
			jdbcType="VARCHAR" />
		<result column="total_organization_code" property="totalOrganizationCode"
			jdbcType="VARCHAR" />
		<result column="new_organization_name" property="organizationName"
			jdbcType="VARCHAR" />
		<result column="organization_level" property="organizationLevel"
			jdbcType="INTEGER" />
		<result column="parent_id" property="parentId" jdbcType="BIGINT" />
		<result column="memo" property="memo" jdbcType="VARCHAR" />
		<result column="create_user_id" property="createUserId"
			jdbcType="BIGINT" />
		<result column="create_user_name" property="createUserName"
			jdbcType="VARCHAR" />
		<result column="create_date" property="createDate" jdbcType="TIMESTAMP" />
		<result column="last_modify_user_id" property="lastModifyUserId"
			jdbcType="BIGINT" />
		<result column="last_modify_user_name" property="lastModifyUserName"
			jdbcType="VARCHAR" />
		<result column="last_modify_date" property="lastModifyDate"
			jdbcType="TIMESTAMP" />
		<result column="sort" property="sort"
			jdbcType="INTEGER" />
	</resultMap>
	  <!-- 原 汇报人 -->
   <resultMap id="SourcePersonResultMap" type="com.jabava.pojo.manage.EhrPerson" >
    <!--
      WARNING - @mbggenerated 
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Dec 22 13:34:15 CST 2015.
    -->
    <id column="person_id" property="personId" jdbcType="BIGINT" />
    <result column="company_id" property="companyId" jdbcType="BIGINT" />
    <result column="organization_id" property="organizationId" jdbcType="BIGINT" />
    <result column="post_id" property="postId" jdbcType="BIGINT" />
    <result column="cost_id" property="costId" jdbcType="BIGINT" />
    <result column="job_number" property="jobNumber" jdbcType="VARCHAR" />
    <result column="so_employee_name" property="employeeName" jdbcType="VARCHAR" />
  </resultMap>
  <!-- 原部门 -->
  	<resultMap id="SourceOrgResultMap" type="com.jabava.pojo.manage.EhrOrganization">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Tue Dec 22 
			13:34:15 CST 2015. -->
		<id column="organization_id" property="organizationId" jdbcType="BIGINT" />
		<result column="company_id" property="companyId" jdbcType="BIGINT" />
		<result column="organization_code" property="organizationCode"
			jdbcType="VARCHAR" />
		<result column="total_organization_code" property="totalOrganizationCode"
			jdbcType="VARCHAR" />
		<result column="so_organization_name" property="organizationName"
			jdbcType="VARCHAR" />
		<result column="organization_level" property="organizationLevel"
			jdbcType="INTEGER" />
		<result column="parent_id" property="parentId" jdbcType="BIGINT" />
		<result column="memo" property="memo" jdbcType="VARCHAR" />
		<result column="create_user_id" property="createUserId"
			jdbcType="BIGINT" />
		<result column="create_user_name" property="createUserName"
			jdbcType="VARCHAR" />
		<result column="create_date" property="createDate" jdbcType="TIMESTAMP" />
		<result column="last_modify_user_id" property="lastModifyUserId"
			jdbcType="BIGINT" />
		<result column="last_modify_user_name" property="lastModifyUserName"
			jdbcType="VARCHAR" />
		<result column="last_modify_date" property="lastModifyDate"
			jdbcType="TIMESTAMP" />
		<result column="sort" property="sort"
			jdbcType="INTEGER" />
	</resultMap>
  	<select id="getByPersonId" resultMap="PostResult">
  		select
  		ehr_jobpost.*,
		np.employee_name AS new_employee_name,		
		new_o.organization_name AS new_organization_name,
		sp.employee_name AS so_employee_name,
		so.organization_id AS organization_id,
		so.organization_name AS so_organization_name		
		
	FROM
		ehr_jobpost
	
	LEFT JOIN ehr_person sp ON ehr_jobpost.source_report = sp.person_id
	LEFT JOIN ehr_organization so ON ehr_jobpost.source_department = so.organization_id
	LEFT JOIN ehr_person np ON ehr_jobpost.new_report = np.person_id
	LEFT JOIN ehr_organization new_o ON ehr_jobpost.new_department = new_o.organization_id
	WHERE 		
  		 ehr_jobpost.person_id=#{personId,jdbcType=BIGINT}
  		 and ehr_jobpost.is_deleted=0
  		 and sp.is_deleted=0
  		 and np.is_deleted=0
  		  
  	</select>
</mapper>