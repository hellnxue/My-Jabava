<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jabava.dao.policygroup.SbGroupMapper" >
  <resultMap id="BaseResultMap" type="com.jabava.pojo.policygroup.SbGroup" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" property="id" jdbcType="BIGINT" />
    <result column="sb_group_name" property="sbGroupName" jdbcType="VARCHAR" />
    <result column="org_id" property="orgId" jdbcType="BIGINT" />
    <result column="privately" property="privately" jdbcType="BIT" />
    <result column="is_deleted" property="isDeleted" jdbcType="INTEGER" />
    <result column="create_by" property="createBy" jdbcType="BIGINT" />
    <result column="create_dt" property="createDt" jdbcType="TIMESTAMP" />
    <result column="update_by" property="updateBy" jdbcType="BIGINT" />
    <result column="update_dt" property="updateDt" jdbcType="TIMESTAMP" />
    <result column="mimic_by" property="mimicBy" jdbcType="BIGINT" />
    <result column="proxy_by" property="proxyBy" jdbcType="BIGINT" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    id, sb_group_name, org_id, privately, is_deleted, create_by, create_dt, update_by, 
    update_dt, mimic_by, proxy_by
  </sql>
    <!-- 根据政策包idList 查询政策包名称 连接一块儿的字符串-->
  <select id="getGroupNamePlus" resultType="java.lang.String"  parameterType="java.util.List">
       SELECT
		GROUP_CONCAT(sb_group_name)
			FROM
				sb_group
			WHERE
			is_deleted =0 and 
				id IN
		 <foreach item="item" index="index" collection="list" open="(" separator="," close=")">
               #{item}
         </foreach>
				
  </select>
  <!-- 根据城市ID和类型获取组合包 -->
  <select id="getGroupByCityAndType" resultMap="BaseResultMap"   parameterType="com.jabava.pojo.policygroup.PolicyGroup"  >
		 SELECT DISTINCT
			sb_group.id,
			sb_group_name
		FROM
			sb_group
		LEFT JOIN sb_group_detail ON sb_group_detail.sb_group_id = sb_group.id
		LEFT JOIN policy_group ON sb_group_detail.policy_group_id = policy_group.id
		WHERE
			sb_group.is_deleted = 0
		AND sb_group_detail.is_deleted = 0
		AND policy_group.is_deleted = 0 
		and policy_group.policy_group_type = #{policyGroupType,jdbcType=VARCHAR}
		AND policy_group.city_code  = #{cityCode,jdbcType=INTEGER}
  </select>
  
    <!-- 根据政策包名称获取政策组合包  -->
  <select id="getGroupByName" resultMap="BaseResultMap" parameterType="java.lang.String" >    
    select 
    <include refid="Base_Column_List" />
    from sb_group
    where  is_deleted =0 
     AND sb_group_name LIKE  CONCAT('%',#{groupName },'%' )  
  </select>
    <!-- 根据idList 获取政策包列表 -->
   <select id="getGroupListByIdList" resultMap="BaseResultMap" parameterType="java.util.List" >    
    select 
    <include refid="Base_Column_List" />
    from sb_group
    where 
           is_deleted =0 and 
				id IN
		 <foreach item="item" index="index" collection="list" open="(" separator="," close=")">
               #{item}
         </foreach>
  </select>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from sb_group
    where id = #{id,jdbcType=BIGINT}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from sb_group
    where id = #{id,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.jabava.pojo.policygroup.SbGroup" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into sb_group (id, sb_group_name, org_id, 
      privately, is_deleted, create_by, 
      create_dt, update_by, update_dt, 
      mimic_by, proxy_by)
    values (#{id,jdbcType=BIGINT}, #{sbGroupName,jdbcType=VARCHAR}, #{orgId,jdbcType=BIGINT}, 
      #{privately,jdbcType=BIT}, #{isDeleted,jdbcType=INTEGER}, #{createBy,jdbcType=BIGINT}, 
      #{createDt,jdbcType=TIMESTAMP}, #{updateBy,jdbcType=BIGINT}, #{updateDt,jdbcType=TIMESTAMP}, 
      #{mimicBy,jdbcType=BIGINT}, #{proxyBy,jdbcType=BIGINT})
  </insert>
  
    <!-- 批量新增更新 如果  id 没有就新增，如果有就更新 --> 
  <insert id="insertOrUpdateList" parameterType="list">
	  <![CDATA[
	 insert into sb_group (
	  id, sb_group_name, org_id, 
      privately, is_deleted, create_by, 
      create_dt, update_by, update_dt, 
      mimic_by, proxy_by
      )
   	    VALUES 
   	  ]]>
		<foreach collection="list" item="item"  index="index" separator=",">
	  (
	  #{item.id,jdbcType=BIGINT}, #{item.sbGroupName,jdbcType=VARCHAR}, #{item.orgId,jdbcType=BIGINT}, 
      #{item.privately,jdbcType=BIT}, #{item.isDeleted,jdbcType=INTEGER}, #{item.createBy,jdbcType=BIGINT}, 
      #{item.createDt,jdbcType=TIMESTAMP}, #{item.updateBy,jdbcType=BIGINT}, #{item.updateDt,jdbcType=TIMESTAMP}, 
      #{item.mimicBy,jdbcType=BIGINT}, #{item.proxyBy,jdbcType=BIGINT}
      )
		</foreach>		
		ON DUPLICATE KEY UPDATE
		id=values(id),
		sb_group_name= values(sb_group_name),
		org_id= values(org_id),
		
		privately=values(privately),
		is_deleted=values(is_deleted),
		create_by=values(create_by),
		create_dt=values(create_dt),		
		
		update_by = values(update_by),
		update_dt = values(update_dt),
		mimic_by = values(mimic_by),
		proxy_by = values(proxy_by)
		
	</insert> 
  <insert id="insertSelective" parameterType="com.jabava.pojo.policygroup.SbGroup" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into sb_group
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="sbGroupName != null" >
        sb_group_name,
      </if>
      <if test="orgId != null" >
        org_id,
      </if>
      <if test="privately != null" >
        privately,
      </if>
      <if test="isDeleted != null" >
        is_deleted,
      </if>
      <if test="createBy != null" >
        create_by,
      </if>
      <if test="createDt != null" >
        create_dt,
      </if>
      <if test="updateBy != null" >
        update_by,
      </if>
      <if test="updateDt != null" >
        update_dt,
      </if>
      <if test="mimicBy != null" >
        mimic_by,
      </if>
      <if test="proxyBy != null" >
        proxy_by,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=BIGINT},
      </if>
      <if test="sbGroupName != null" >
        #{sbGroupName,jdbcType=VARCHAR},
      </if>
      <if test="orgId != null" >
        #{orgId,jdbcType=BIGINT},
      </if>
      <if test="privately != null" >
        #{privately,jdbcType=BIT},
      </if>
      <if test="isDeleted != null" >
        #{isDeleted,jdbcType=INTEGER},
      </if>
      <if test="createBy != null" >
        #{createBy,jdbcType=BIGINT},
      </if>
      <if test="createDt != null" >
        #{createDt,jdbcType=TIMESTAMP},
      </if>
      <if test="updateBy != null" >
        #{updateBy,jdbcType=BIGINT},
      </if>
      <if test="updateDt != null" >
        #{updateDt,jdbcType=TIMESTAMP},
      </if>
      <if test="mimicBy != null" >
        #{mimicBy,jdbcType=BIGINT},
      </if>
      <if test="proxyBy != null" >
        #{proxyBy,jdbcType=BIGINT},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.jabava.pojo.policygroup.SbGroup" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update sb_group
    <set >
      <if test="sbGroupName != null" >
        sb_group_name = #{sbGroupName,jdbcType=VARCHAR},
      </if>
      <if test="orgId != null" >
        org_id = #{orgId,jdbcType=BIGINT},
      </if>
      <if test="privately != null" >
        privately = #{privately,jdbcType=BIT},
      </if>
      <if test="isDeleted != null" >
        is_deleted = #{isDeleted,jdbcType=INTEGER},
      </if>
      <if test="createBy != null" >
        create_by = #{createBy,jdbcType=BIGINT},
      </if>
      <if test="createDt != null" >
        create_dt = #{createDt,jdbcType=TIMESTAMP},
      </if>
      <if test="updateBy != null" >
        update_by = #{updateBy,jdbcType=BIGINT},
      </if>
      <if test="updateDt != null" >
        update_dt = #{updateDt,jdbcType=TIMESTAMP},
      </if>
      <if test="mimicBy != null" >
        mimic_by = #{mimicBy,jdbcType=BIGINT},
      </if>
      <if test="proxyBy != null" >
        proxy_by = #{proxyBy,jdbcType=BIGINT},
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.jabava.pojo.policygroup.SbGroup" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update sb_group
    set sb_group_name = #{sbGroupName,jdbcType=VARCHAR},
      org_id = #{orgId,jdbcType=BIGINT},
      privately = #{privately,jdbcType=BIT},
      is_deleted = #{isDeleted,jdbcType=INTEGER},
      create_by = #{createBy,jdbcType=BIGINT},
      create_dt = #{createDt,jdbcType=TIMESTAMP},
      update_by = #{updateBy,jdbcType=BIGINT},
      update_dt = #{updateDt,jdbcType=TIMESTAMP},
      mimic_by = #{mimicBy,jdbcType=BIGINT},
      proxy_by = #{proxyBy,jdbcType=BIGINT}
    where id = #{id,jdbcType=BIGINT}
  </update>
</mapper>